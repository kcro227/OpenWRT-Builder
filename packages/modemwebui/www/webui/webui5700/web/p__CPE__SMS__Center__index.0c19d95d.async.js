"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[90],{6038:function(rr,De,S){S.r(De),S.d(De,{default:function(){return Bn}});var $e=S(19632),U=S.n($e),_e=S(97857),Y=S.n(_e),en=S(64599),ue=S.n(en),nn=S(15009),F=S.n(nn),rn=S(99289),O=S.n(rn),an=S(5574),x=S.n(an),k=S(67294),Fe=S(86744),Se=S(26058),tn=S(78301),Z=S(2453),Ce=S(41730),oe=S(2487),sn=S(84567),un=S(16568),on=S(36039),ye=S(78957),ln=S(38703),J=S(77683),cn=S(68997),fn=S(40411),be=S(27496),dn=S(98165),vn=S(87547),hn=S(38545),mn=S(59955),gn=S(12444),pn=S.n(gn),Sn=S(72004),Cn=S.n(Sn),yn=function(){function fe(){pn()(this,fe)}return Cn()(fe,[{key:"stringToHex",value:function(B){return Array.from(B).map(function(T){return T.charCodeAt(0).toString(16).padStart(2,"0")}).join("").toUpperCase()}},{key:"encodeGSM7bit",value:function(B){for(var T="",C=0;C<B.length;C++){var H=B.charCodeAt(C)&127;T+=H.toString(2).padStart(7,"0")}var z=(8-T.length%8)%8;z&&(T+="0".repeat(z));for(var N="",A=0;A<T.length;A+=8)N+=parseInt(T.substring(A,A+8),2).toString(16).padStart(2,"0");return N.toUpperCase()}},{key:"encodeUCS2",value:function(B){for(var T="",C=0;C<B.length;C++){var H=B.charCodeAt(C);T+=H.toString(16).padStart(4,"0")}return T.toUpperCase()}},{key:"hexToBytes",value:function(B){if(B.length%2!==0)throw new Error("Invalid hex string length");for(var T=new Uint8Array(B.length/2),C=0;C<B.length;C+=2)T[C/2]=parseInt(B.substring(C,C+2),16);return T}},{key:"encodeNumber",value:function(B){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!B)throw new Error("Number is required");for(var C=B.startsWith("+")?B.slice(1):B,H=C.length,z=H%2===0?C:C+"F",N="",A=0;A<z.length;A+=2)N+=z[A+1]+z[A];var _="91"+N,ee=T?Math.floor(_.length/2):H;return ee.toString(16).padStart(2,"0")+_}},{key:"encode",value:function(B){try{var T=this.encodeNumber(B.smsc,!0),C="11",H="00",z=this.encodeNumber(B.destination),N="00",A=B.encoding||"7bit",_=A==="ucs2"?"08":"00",ee=A==="ucs2"?this.encodeUCS2(B.message):this.encodeGSM7bit(B.message),D=A==="ucs2"?B.message.length*2:B.message.length,R=B.validityPeriod?Math.min(Math.max(B.validityPeriod,0),40320).toString(16).padStart(2,"0"):"AA",de="".concat(C).concat(H).concat(z).concat(N).concat(_).concat(R).concat(D.toString(16).padStart(2,"0")).concat(ee),ve="".concat(T).concat(de),ne=de.length/2;return{pdu:ve,tpduLength:ne}}catch(re){throw new Error("PDU encoding failed: ".concat(re.message))}}}]),fe}(),bn=S(96486),Te=S(36009),c=S(85893),ke=Fe.Z.TextArea,Tn=Se.Z.Sider,En=Se.Z.Content,le=tn.Z.Text,wn=function(){var X=(0,k.useState)([]),B=x()(X,2),T=B[0],C=B[1],H=(0,k.useState)([]),z=x()(H,2),N=z[0],A=z[1],_=(0,k.useState)(""),ee=x()(_,2),D=ee[0],R=ee[1],de=(0,k.useState)(""),ve=x()(de,2),ne=ve[0],re=ve[1],Dn=(0,k.useState)(""),xe=x()(Dn,2),Ee=xe[0],we=xe[1],Fn=(0,k.useState)(!1),Ae=x()(Fn,2),ae=Ae[0],V=Ae[1],kn=(0,k.useState)(!1),Me=x()(kn,2),xn=Me[0],he=Me[1],An=(0,k.useState)(!1),je=x()(An,2),Mn=je[0],me=je[1],jn=(0,k.useState)(!1),Ze=x()(jn,2),q=Ze[0],Pe=Ze[1],Zn=(0,k.useState)([]),Ne=x()(Zn,2),G=Ne[0],$=Ne[1],Pn=(0,k.useState)(!1),Ie=x()(Pn,2),Ge=Ie[0],Le=Ie[1],Nn=(0,k.useState)({used:0,total:0}),Ue=x()(Nn,2),te=Ue[0],In=Ue[1],Gn=(0,k.useState)(!0),Oe=x()(Gn,2),ze=Oe[0],Ln=Oe[1],Un=(0,k.useState)(!1),We=x()(Un,2),ar=We[0],tr=We[1],On=(0,k.useState)(!1),He=x()(On,2),Ke=He[0],Qe=He[1],zn=(0,k.useState)(!0),Ve=x()(zn,2),ce=Ve[0],Wn=Ve[1],W=mn.S.getInstance(),Be=(0,k.useRef)(new Map),Ye=function(){var d=O()(F()().mark(function n(a){var t,l,r,i=arguments;return F()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=i.length>1&&i[1]!==void 0?i[1]:!1,l=a,!(!t&&Be.current.has(l))){e.next=4;break}return e.abrupt("return",Be.current.get(l));case 4:return e.next=6,W.sendCommand(a);case 6:return r=e.sent,r.success&&Be.current.set(l,r),e.abrupt("return",r);case 9:case"end":return e.stop()}},n)}));return function(a){return d.apply(this,arguments)}}(),ge=function(){var d=O()(F()().mark(function n(){var a,t,l;return F()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,W.getSMSStorage();case 3:a=i.sent,a.success&&a.data&&(t=String(a.data),l=t.match(/\+CPMS: "\w+",(\d+),(\d+)/),l&&In({used:parseInt(l[1]),total:parseInt(l[2])})),i.next=10;break;case 7:i.prev=7,i.t0=i.catch(0),console.error("\u83B7\u53D6\u5B58\u50A8\u7A7A\u95F4\u4FE1\u606F\u5931\u8D25:",i.t0);case 10:case"end":return i.stop()}},n,null,[[0,7]])}));return function(){return d.apply(this,arguments)}}(),Hn=function(){var d=O()(F()().mark(function n(){var a,t,l,r;return F()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,console.log("\u5F00\u59CB\u521D\u59CB\u5316SMS\u4E2D\u5FC3..."),s.next=4,W.connect();case 4:if(a=s.sent,console.log("WebSocket\u8FDE\u63A5\u72B6\u6001:",a),!a){s.next=32;break}return console.log("\u68C0\u67E5IMS\u72B6\u6001..."),s.next=10,Ye("AT^IMSSWITCH?");case 10:return t=s.sent,console.log("IMS\u72B6\u6001\u68C0\u67E5\u7ED3\u679C:",t),t.success&&t.data&&(l=t.data.includes(": 1"),Wn(l),l||Z.ZP.warning("IMS\u529F\u80FD\u672A\u5F00\u542F\uFF0C\u77ED\u4FE1\u529F\u80FD\u4E0D\u53EF\u7528")),console.log("\u68C0\u67E5\u77ED\u4FE1\u529F\u80FD\u662F\u5426\u5F00\u542F..."),s.next=16,Ye("AT+CMGF?");case 16:if(r=s.sent,console.log("\u77ED\u4FE1\u529F\u80FD\u68C0\u67E5\u7ED3\u679C:",r),r.success){s.next=22;break}return Z.ZP.warning("\u77ED\u4FE1\u529F\u80FD\u672A\u5F00\u542F\u6216\u4E0D\u53EF\u7528\uFF0C\u8BF7\u5148\u524D\u5F80\u8BBE\u7F6E\u9875\u9762\u5F00\u542F\u77ED\u4FE1\u529F\u80FD"),Le(!1),s.abrupt("return");case 22:return Le(!0),console.log("\u77ED\u4FE1\u529F\u80FD\u5DF2\u5F00\u542F"),console.log("\u83B7\u53D6\u5B58\u50A8\u7A7A\u95F4\u4FE1\u606F..."),s.next=27,ge();case 27:return console.log("\u5F00\u59CB\u5237\u65B0\u77ED\u4FE1\u5217\u8868..."),s.next=30,se();case 30:s.next=34;break;case 32:console.log("\u8FDE\u63A5\u5931\u8D25"),Z.ZP.error("\u8FDE\u63A5\u670D\u52A1\u5668\u5931\u8D25");case 34:s.next=40;break;case 36:s.prev=36,s.t0=s.catch(0),console.error("\u521D\u59CB\u5316\u5931\u8D25:",s.t0),Z.ZP.error("\u521D\u59CB\u5316\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC\u8FDE\u63A5");case 40:case"end":return s.stop()}},n,null,[[0,36]])}));return function(){return d.apply(this,arguments)}}();(0,k.useEffect)(function(){return Hn(),function(){console.log("\u7EC4\u4EF6\u5378\u8F7D\uFF0C\u4E0D\u65AD\u5F00\u8FDE\u63A5\u4EE5\u907F\u514D\u5F71\u54CD\u5176\u4ED6\u9875\u9762")}},[]),(0,k.useEffect)(function(){if(D){console.log("\u9009\u62E9\u4E86\u8054\u7CFB\u4EBA:",D),C([]);var d=N.find(function(n){return E(n.number)===E(D)});d&&d.messages&&d.messages.length>0?(console.log("\u4ECE\u7F13\u5B58\u4E2D\u52A0\u8F7D\u8054\u7CFB\u4EBA\u6D88\u606F:",d.messages.length,"\u6761"),C(d.messages.sort(function(n,a){var t=P(n.time),l=P(a.time);return t.getTime()-l.getTime()}))):(console.log("\u4ECE\u670D\u52A1\u5668\u52A0\u8F7D\u8054\u7CFB\u4EBA\u6D88\u606F"),setTimeout(function(){Kn(D)},100))}},[D,N]),(0,k.useEffect)(function(){console.log("\u6D88\u606F\u5217\u8868\u5DF2\u66F4\u65B0:",T)},[T]);var Kn=function(){var d=O()(F()().mark(function n(a){var t,l,r,i;return F()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,V(!0),console.log("\u5F00\u59CB\u52A0\u8F7D\u8054\u7CFB\u4EBA ".concat(a," \u7684\u6D88\u606F")),e.next=5,W.listAllSMS();case 5:if(t=e.sent,t.success){e.next=9;break}throw console.error("\u83B7\u53D6\u77ED\u4FE1\u5217\u8868\u5931\u8D25:",t.error),new Error("\u83B7\u53D6\u77ED\u4FE1\u5217\u8868\u5931\u8D25");case 9:if(!(!t.data||t.data==="NO SMS"||t.data==="OK")){e.next=13;break}return console.log("\u6CA1\u6709\u77ED\u4FE1\u6216\u54CD\u5E94\u4E3A\u7A7A"),C([]),e.abrupt("return");case 13:console.log("\u6210\u529F\u83B7\u53D6\u77ED\u4FE1\u5217\u8868\uFF0C\u5F00\u59CB\u89E3\u6790\u6D88\u606F"),l=Je(typeof t.data=="string"?t.data:JSON.stringify(t.data)),r=E(a),console.log("\u89E3\u6790\u5230 ".concat(l.length," \u6761\u77ED\u4FE1\uFF0C\u7B5B\u9009\u8054\u7CFB\u4EBA ").concat(r," \u7684\u6D88\u606F")),console.log("\u6240\u6709\u6D88\u606F\u53F7\u7801:",l.map(function(u){return{index:u.index,number:u.number,normalizedNumber:E(u.number),content:u.content.substring(0,20)+(u.content.length>20?"...":"")}})),i=l.filter(function(u){var m=E(u.number),f=m===r;return console.log("\u6D88\u606F ".concat(u.index," \u53F7\u7801 ").concat(u.number," \u6807\u51C6\u5316\u540E ").concat(m," \u4E0E\u8054\u7CFB\u4EBA ").concat(r," \u5339\u914D: ").concat(f)),f}).sort(function(u,m){var f=P(u.time),y=P(m.time);return f.getTime()-y.getTime()}),console.log("\u7B5B\u9009\u51FA ".concat(i.length," \u6761\u8054\u7CFB\u4EBA\u6D88\u606F:"),i.map(function(u){return{index:u.index,content:u.content.substring(0,20)+(u.content.length>20?"...":""),time:u.time}})),i.length>0?C(i):(console.log("\u6CA1\u6709\u627E\u5230\u8BE5\u8054\u7CFB\u4EBA\u7684\u6D88\u606F"),C([])),e.next=28;break;case 23:e.prev=23,e.t0=e.catch(0),console.error("\u83B7\u53D6\u8054\u7CFB\u4EBA\u6D88\u606F\u5931\u8D25:",e.t0),Z.ZP.error("\u83B7\u53D6\u8054\u7CFB\u4EBA\u6D88\u606F\u5931\u8D25\uFF1A"+(e.t0 instanceof Error?e.t0.message:"\u672A\u77E5\u9519\u8BEF")),C([]);case 28:return e.prev=28,V(!1),e.finish(28);case 31:case"end":return e.stop()}},n,null,[[0,23,28,31]])}));return function(a){return d.apply(this,arguments)}}(),Je=function(n){console.log("\u5F00\u59CB\u89E3\u6790\u77ED\u4FE1\u6570\u636E..."),console.log("\u539F\u59CB\u6570\u636E:",n);var a=[];try{var t,l=n;if(typeof n=="string")try{var r=JSON.parse(n);r.success&&r.data&&(l=r.data)}catch(b){var i=l.match(/\+CMGL:[\s\S]*?(?=\+CMGL:|$)/g);i&&(l=i.join(`
`))}for(var s=l.split(/\r?\n/).filter(function(b){return b.trim()}),e=null,u=0;u<s.length;u++){var m=s[u].trim();if(console.log("\u5904\u7406\u7B2C ".concat(u+1," \u884C:"),m),!(!m||m==="OK"||m.startsWith("AT+"))){var f=m.match(/\+CMGL: (\d+),(\d+),,(\d+)/g);if(f){var y;(y=e)!==null&&y!==void 0&&y.index&&e.pdu&&(pe(e,a),e=null);var g=ue()(f),p;try{for(g.s();!(p=g.n()).done;){var w=p.value,M=w.match(/\+CMGL: (\d+),(\d+),,(\d+)/);M&&(e={index:M[1],status:M[2]},console.log("\u89E3\u6790CMGL\u884C\u7ED3\u679C:",e))}}catch(b){g.e(b)}finally{g.f()}continue}if(m.startsWith("+CMGL:")){var v;(v=e)!==null&&v!==void 0&&v.index&&e.pdu&&(pe(e,a),e=null);var o=m.match(/\+CMGL: (\d+),(\d+),,(\d+)/);o&&(e={index:o[1],status:o[2]})}else e&&!e.pdu&&(/^[0-9A-F]+$/i.test(m)&&(e.pdu=m,pe(e,a)),e=null)}}return(t=e)!==null&&t!==void 0&&t.index&&e.pdu&&pe(e,a),a}catch(b){return a}},pe=function(n,a){try{if(!n.index||!n.pdu)return;var t=parseInt(n.index);if(a.some(function(ie){return ie.index===t}))return;var l=n.pdu.replace(/\r/g,"");if(l.length<20)return;var r=Te.Qc(l);if(r instanceof Te.pQ){var i,s,e,u=((i=r._address)===null||i===void 0?void 0:i._phone)||"",m=((s=r._data)===null||s===void 0?void 0:s.getText())||"",f=!1,y=null;if((e=r._data)!==null&&e!==void 0&&(e=e._parts)!==null&&e!==void 0&&(e=e[0])!==null&&e!==void 0&&(e=e.header)!==null&&e!==void 0&&(e=e.ies)!==null&&e!==void 0&&(e=e[0])!==null&&e!==void 0&&e.data){var g=r._data._parts[0].header.ies[0].data;g.maxMsgNum&&g.msgRef&&g.msgSeqNo&&(y={ref:g.msgRef,total:g.maxMsgNum,seq:g.msgSeqNo},f=!0)}var p=null;if(r._serviceCenterTimeStamp){var w=r._serviceCenterTimeStamp,M=w.time,v=w.tzOff;if(M){var o=M*1e3,b=new Date().getTimezoneOffset(),L=v,h=(L+b)*60*1e3;p=new Date(o+h)}}if(u&&m){var j=Y()({index:t,content:m,number:E(u),time:Xe(p||new Date),type:"received",isConcatenated:f},f&&y&&{concatenatedRef:y.ref,concatenatedSeq:y.seq,concatenatedTotal:y.total});a.push(j)}}}catch(ie){}},sr=function(n,a){try{if(!n)return null;var t="",l="",r=null,i={isConcatenated:!1,ref:0,seq:0,total:0};if(n instanceof Te.pQ){var s,e,u,m;if(l=((s=n._address)===null||s===void 0?void 0:s._phone)||"",(e=n._data)!==null&&e!==void 0&&(e=e._parts)!==null&&e!==void 0&&(e=e[0])!==null&&e!==void 0&&(e=e.header)!==null&&e!==void 0&&(e=e.ies)!==null&&e!==void 0&&(e=e[0])!==null&&e!==void 0&&e.data){var f=n._data._parts[0].header.ies[0].data;f.maxMsgNum&&f.msgRef&&f.msgSeqNo&&(i={isConcatenated:!0,ref:f.msgRef,seq:f.msgSeqNo,total:f.maxMsgNum})}t=((u=n._data)===null||u===void 0?void 0:u.getText())||"",(m=n._serviceCenterTimeStamp)!==null&&m!==void 0&&m.time&&(r=new Date(n._serviceCenterTimeStamp.time*1e3))}return Y()({index:a,content:t,number:E(l),time:Xe(r||new Date),type:"received"},i.isConcatenated&&{isConcatenated:!0,concatenatedRef:i.ref,concatenatedSeq:i.seq,concatenatedTotal:i.total})}catch(y){return null}},Xe=function(n){try{var a=n instanceof Date?n:new Date(n);if(isNaN(a.getTime()))return new Date().toLocaleString("zh-CN");var t=a.toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}),l=t.split(" "),r=x()(l,2),i=r[0],s=r[1],e=i.split("/"),u=x()(e,3),m=u[0],f=u[1],y=u[2];return"".concat(m.slice(-2),"/").concat(f,"/").concat(y,",").concat(s)}catch(g){return new Date().toLocaleString("zh-CN")}},E=function(n){if(!n)return"";var a=n.replace(/^\+/,"");if(a.startsWith("86")&&a.length>2){var t=a.substring(2);if(/^\d+$/.test(t))return t}if(/^\d+$/.test(a))return a;var l=a.replace(/\D/g,"");return l.length>0?l:a},se=(0,k.useCallback)((0,bn.debounce)(O()(F()().mark(function d(){var n,a,t=arguments;return F()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(n=t.length>0&&t[0]!==void 0?t[0]:!1,!Ke){r.next=4;break}return console.log("\u6B63\u5728\u52A0\u8F7D\u4E2D\uFF0C\u8DF3\u8FC7\u5237\u65B0"),r.abrupt("return");case 4:return r.prev=4,console.log("\u5F00\u59CB\u5237\u65B0\u6D88\u606F\u5217\u8868"),Qe(!0),he(!0),r.next=10,W.listAllSMS();case 10:a=r.sent,console.log("\u83B7\u53D6\u77ED\u4FE1\u5217\u8868\u54CD\u5E94:",a),a!=null&&a.success?$n(a):(console.error("\u83B7\u53D6\u77ED\u4FE1\u5217\u8868\u5931\u8D25:",a==null?void 0:a.error),Z.ZP.error("\u83B7\u53D6\u77ED\u4FE1\u5217\u8868\u5931\u8D25")),r.next=19;break;case 15:r.prev=15,r.t0=r.catch(4),console.error("\u5237\u65B0\u6D88\u606F\u5217\u8868\u5931\u8D25:",r.t0),Z.ZP.error("\u83B7\u53D6\u77ED\u4FE1\u5217\u8868\u5931\u8D25\uFF1A"+(r.t0 instanceof Error?r.t0.message:"\u672A\u77E5\u9519\u8BEF"));case 19:return r.prev=19,Qe(!1),he(!1),ze&&Ln(!1),r.finish(19);case 24:case"end":return r.stop()}},d,null,[[4,15,19,24]])})),500),[Ke,D,ze]),P=function(n){try{if(!n)return new Date;var a=String(n).trim();if(a.includes(",")){var t=a.split(","),l=x()(t,2),r=l[0],i=l[1],s=r.split("/"),e=x()(s,3),u=e[0],m=e[1],f=e[2],y=parseInt(u)<50?"20".concat(u):"19".concat(u),g="".concat(y,"-").concat(m,"-").concat(f,"T").concat(i),p=new Date(g);if(!isNaN(p.getTime()))return p}if(/^\d+$/.test(a)){var w=parseInt(a),M=w>9999999999?w:w*1e3,v=new Date(M);if(!isNaN(v.getTime()))return v}return console.warn("\u65E0\u6CD5\u89E3\u6790\u65F6\u95F4\u683C\u5F0F:",a),new Date}catch(o){return console.error("\u65F6\u95F4\u89E3\u6790\u9519\u8BEF:",n,o),new Date}},Qn=function(n){try{if(n.includes(",")){var a=n.split(","),t=x()(a,2),l=t[0],r=t[1],i=l.split("/"),s=x()(i,3),e=s[0],u=s[1],m=s[2];return"20".concat(e,"\u5E74").concat(u,"\u6708").concat(m,"\u65E5 ").concat(r)}else return n}catch(f){return console.error("Time format error:",n,f),n}},Vn=function(n){var a=E(n);return/^\d{5,19}$/.test(a)},ir=function(){var d=O()(F()().mark(function n(a){return F()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:Ce.Z.confirm({title:"\u786E\u8BA4\u5220\u9664",content:"\u786E\u5B9A\u8981\u5220\u9664\u8FD9\u6761\u77ED\u4FE1\u5417\uFF1F\u6B64\u64CD\u4F5C\u65E0\u6CD5\u64A4\u9500\u3002",okText:"\u5220\u9664",cancelText:"\u53D6\u6D88",okButtonProps:{danger:!0},onOk:function(){var r=O()(F()().mark(function s(){var e,u,m,f,y,g,p,w;return F()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(v.prev=0,V(!0),e=T.find(function(o){return o.index===a}),e){v.next=5;break}return v.abrupt("return");case 5:u=[a],e.isConcatenated&&e.concatenatedRef!==void 0&&(console.log("\u5220\u9664\u5206\u6BB5\u77ED\u4FE1:",{\u5F15\u7528\u53F7:e.concatenatedRef,\u5F53\u524D\u6BB5:e.concatenatedSeq,\u603B\u6BB5\u6570:e.concatenatedTotal}),m=T.filter(function(o){return o.isConcatenated&&o.concatenatedRef===e.concatenatedRef&&o.number===e.number}),u=m.sort(function(o,b){return o.index-b.index}).map(function(o){return o.index}),console.log("\u9700\u8981\u5220\u9664\u7684\u6240\u6709\u5206\u6BB5\u7D22\u5F15:",u)),f=ue()(u),v.prev=8,f.s();case 10:if((y=f.n()).done){v.next=22;break}return g=y.value,console.log("\u5220\u9664\u77ED\u4FE1\u7D22\u5F15 ".concat(g)),v.next=15,W.sendCommand("AT+CMGD=".concat(g));case 15:if(p=v.sent,p.success){v.next=18;break}throw new Error(p.error||"\u5220\u9664\u77ED\u4FE1\u5931\u8D25");case 18:return v.next=20,new Promise(function(o){return setTimeout(o,500)});case 20:v.next=10;break;case 22:v.next=27;break;case 24:v.prev=24,v.t0=v.catch(8),f.e(v.t0);case 27:return v.prev=27,f.f(),v.finish(27);case 30:return C(function(o){return o.filter(function(b){return!u.includes(b.index)})}),w=T.filter(function(o){return!u.includes(o.index)}),D&&!w.some(function(o){return E(o.number)===E(D)})&&(A(function(o){return o.filter(function(b){return E(b.number)!==E(D)})}),R("")),v.next=35,new Promise(function(o){return setTimeout(o,1e3)});case 35:return v.next=37,Promise.all([se(!0),ge()]);case 37:Z.ZP.success("\u6210\u529F\u5220\u9664".concat(u.length>1?"\u5206\u6BB5":"","\u77ED\u4FE1")),v.next=44;break;case 40:v.prev=40,v.t1=v.catch(0),console.error("\u5220\u9664\u77ED\u4FE1\u51FA\u9519:",v.t1),Z.ZP.error("\u5220\u9664\u5931\u8D25\uFF1A"+(v.t1 instanceof Error?v.t1.message:"\u672A\u77E5\u9519\u8BEF"));case 44:return v.prev=44,V(!1),v.finish(44);case 47:case"end":return v.stop()}},s,null,[[0,40,44,47],[8,24,27,30]])}));function i(){return r.apply(this,arguments)}return i}()});case 1:case"end":return l.stop()}},n)}));return function(a){return d.apply(this,arguments)}}(),Yn=function(){var d=O()(F()().mark(function n(){return F()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(G.length!==0){t.next=3;break}return Z.ZP.warning("\u8BF7\u5148\u9009\u62E9\u8981\u5220\u9664\u7684\u77ED\u4FE1"),t.abrupt("return");case 3:Ce.Z.confirm({title:"\u786E\u8BA4\u5220\u9664",content:"\u786E\u5B9A\u5220\u9664\u9009\u4E2D\u7684 ".concat(G.length," \u6761\u77ED\u4FE1\u5417\uFF1F\u6B64\u64CD\u4F5C\u65E0\u6CD5\u64A4\u9500\u3002"),okText:"\u5220\u9664",cancelText:"\u53D6\u6D88",okButtonProps:{danger:!0},onOk:function(){var l=O()(F()().mark(function i(){var s,e,u,m,f,y,g,p,w,M;return F()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:o.prev=0,V(!0),s=new Set,e=ue()(G),o.prev=4,m=F()().mark(function b(){var L,h,j;return F()().wrap(function(K){for(;;)switch(K.prev=K.next){case 0:if(L=u.value,h=T.find(function(I){return I.index===L}),h){K.next=4;break}return K.abrupt("return",1);case 4:h.isConcatenated&&h.concatenatedRef!==void 0?(console.log("\u5904\u7406\u5206\u6BB5\u77ED\u4FE1\u5220\u9664:",{\u5F15\u7528\u53F7:h.concatenatedRef,\u53F7\u7801:h.number}),j=T.filter(function(I){return I.isConcatenated&&I.concatenatedRef===h.concatenatedRef&&I.number===h.number}),j.forEach(function(I){s.add(I.index);var Q=G.indexOf(I.index);Q>-1&&G.splice(Q,1)})):s.add(L);case 5:case"end":return K.stop()}},b)}),e.s();case 7:if((u=e.n()).done){o.next=13;break}return o.delegateYield(m(),"t0",9);case 9:if(!o.t0){o.next=11;break}return o.abrupt("continue",11);case 11:o.next=7;break;case 13:o.next=18;break;case 15:o.prev=15,o.t1=o.catch(4),e.e(o.t1);case 18:return o.prev=18,e.f(),o.finish(18);case 21:f=Array.from(s).sort(function(b,L){return b-L}),console.log("\u8981\u5220\u9664\u7684\u6D88\u606F\u7D22\u5F15:",f),y=ue()(f),o.prev=24,y.s();case 26:if((g=y.n()).done){o.next=38;break}return p=g.value,console.log("\u5220\u9664\u77ED\u4FE1\u7D22\u5F15 ".concat(p)),o.next=31,W.sendCommand("AT+CMGD=".concat(p));case 31:if(w=o.sent,w.success){o.next=34;break}throw new Error(w.error||"\u6279\u91CF\u5220\u9664\u77ED\u4FE1\u5931\u8D25");case 34:return o.next=36,new Promise(function(b){return setTimeout(b,500)});case 36:o.next=26;break;case 38:o.next=43;break;case 40:o.prev=40,o.t2=o.catch(24),y.e(o.t2);case 43:return o.prev=43,y.f(),o.finish(43);case 46:return Z.ZP.success("\u6210\u529F\u5220\u9664 ".concat(f.length," \u6761\u77ED\u4FE1")),$([]),Pe(!1),C(function(b){return b.filter(function(L){return!f.includes(L.index)})}),M=T.filter(function(b){return!f.includes(b.index)}),D&&!M.some(function(b){return E(b.number)===E(D)})&&(A(function(b){return b.filter(function(L){return E(L.number)!==E(D)})}),R("")),o.next=54,new Promise(function(b){return setTimeout(b,1e3)});case 54:return o.next=56,Promise.all([se(!0),ge()]);case 56:o.next=62;break;case 58:o.prev=58,o.t3=o.catch(0),console.error("\u6279\u91CF\u5220\u9664\u77ED\u4FE1\u51FA\u9519:",o.t3),Z.ZP.error("\u6279\u91CF\u5220\u9664\u5931\u8D25\uFF1A"+(o.t3 instanceof Error?o.t3.message:"\u672A\u77E5\u9519\u8BEF"));case 62:return o.prev=62,V(!1),o.finish(62);case 65:case"end":return o.stop()}},i,null,[[0,58,62,65],[4,15,18,21],[24,40,43,46]])}));function r(){return l.apply(this,arguments)}return r}()});case 4:case"end":return t.stop()}},n)}));return function(){return d.apply(this,arguments)}}(),Re=function(){var d=O()(F()().mark(function n(){var a,t,l,r,i,s,e,u,m,f,y,g,p,w,M,v,o,b;return F()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(a=ne.trim(),a){h.next=4;break}return Z.ZP.warning("\u8BF7\u8F93\u5165\u77ED\u4FE1\u5185\u5BB9"),h.abrupt("return");case 4:if(t=D||Ee.trim(),t){h.next=8;break}return Z.ZP.warning("\u8BF7\u8F93\u5165\u8054\u7CFB\u4EBA\u53F7\u7801"),h.abrupt("return");case 8:if(Vn(E(t))){h.next=11;break}return Z.ZP.warning("\u8BF7\u8F93\u5165\u6B63\u786E\u76845-19\u4F4D\u624B\u673A\u53F7\u7801"),h.abrupt("return");case 11:return h.prev=11,V(!0),h.next=15,W.sendCommand("AT+CMGF?");case 15:if(l=h.sent,!(!l.success||typeof l.data=="string"&&!l.data.includes("0"))){h.next=19;break}return h.next=19,W.sendCommand("AT+CMGF=0");case 19:return h.next=21,new Promise(function(j){return setTimeout(j,1e3)});case 21:return h.next=23,W.sendCommand("AT+CSCA?");case 23:return r=h.sent,i="",r.success&&typeof r.data=="string"&&(s=r.data.match(/\+CSCA: "([^"]+)",\d+/),s&&s[1]&&(i=s[1])),e=new yn,u=t.replace(/^\+/,""),!u.startsWith("86")&&u.length===11&&(u="86"+u),u.startsWith("+")||(u="+"+u),m=e.encode({smsc:i||"",destination:u,message:a,encoding:"ucs2",validityPeriod:167}),f=m.pdu,y=m.tpduLength,g="AT+CMGS=".concat(y,"\\r").concat(f),h.next=34,W.sendCommand(g);case 34:if(p=h.sent,p.success){h.next=37;break}throw new Error("\u53D1\u9001\u5931\u8D25\uFF1A"+(p.error||"\u672A\u77E5\u9519\u8BEF"));case 37:return Z.ZP.success("\u53D1\u9001\u6210\u529F"),w=E(t),M={index:-1,content:a,number:w,time:new Date().toLocaleString("zh-CN",{hour12:!1,year:"2-digit",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).replace(/(\d{2})\/(\d{2})\/(\d{2}) (\d{2}):(\d{2}):(\d{2})/,"$1/$2/$3,$4:$5:$6"),type:"sent"},C(function(j){return[].concat(U()(j),[M])}),v=N.findIndex(function(j){return E(j.number)===w}),v>-1?(o=U()(N),o[v]=Y()(Y()({},o[v]),{},{lastMessage:a,lastTime:M.time,messages:[].concat(U()(o[v].messages),[M])}),A(o)):(b={number:w,lastMessage:a,lastTime:M.time,unreadCount:0,messages:[M]},A(function(j){return[b].concat(U()(j))})),re(""),D||(R(w),we(""),me(!1)),h.next=47,se(!0);case 47:h.next=52;break;case 49:h.prev=49,h.t0=h.catch(11),Z.ZP.error("\u53D1\u9001\u5931\u8D25\uFF1A"+(h.t0 instanceof Error?h.t0.message:"\u8BF7\u68C0\u67E5\u77ED\u4FE1\u529F\u80FD\u5F00\u5173\u662F\u5426\u5173\u95ED\u6216\u5176\u4ED6\u539F\u56E0"));case 52:return h.prev=52,V(!1),h.finish(52);case 55:case"end":return h.stop()}},n,null,[[11,49,52,55]])}));return function(){return d.apply(this,arguments)}}(),Jn=function(n){if(n.isConcatenated&&n.concatenatedRef!==void 0){var a=T.filter(function(r){return r.isConcatenated&&r.concatenatedRef===n.concatenatedRef&&r.number===n.number}),t=a.map(function(r){return r.index}),l=t.every(function(r){return G.includes(r)});$(l?function(r){return r.filter(function(i){return!t.includes(i)})}:function(r){return[].concat(U()(r),U()(t.filter(function(i){return!r.includes(i)})))})}else G.includes(n.index)?$(function(r){return r.filter(function(i){return i!==n.index})}):$(function(r){return[].concat(U()(r),[n.index])})},Xn=function(n){return(0,c.jsx)(oe.Z.Item,{style:{display:"block",padding:"8px 0",marginBottom:"16px",width:"100%"},children:(0,c.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:n.type==="sent"?"flex-end":"flex-start",width:"100%"},children:(0,c.jsxs)("div",{style:{display:"flex",flexDirection:n.type==="sent"?"row-reverse":"row",alignItems:"center",gap:"8px",width:"100%"},children:[q&&(0,c.jsx)(sn.Z,{checked:n.isConcatenated?T.filter(function(a){return a.isConcatenated&&a.concatenatedRef===n.concatenatedRef&&a.number===n.number}).every(function(a){return G.includes(a.index)}):G.includes(n.index),onChange:function(){return Jn(n)}}),(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column",maxWidth:"70%"},children:[(0,c.jsx)(le,{type:"secondary",style:{fontSize:"12px",marginBottom:"4px",textAlign:n.type==="sent"?"right":"left"},children:Qn(n.time)}),(0,c.jsxs)("div",{style:{padding:"12px 16px",background:n.type==="sent"?"#1890ff":"#f0f0f0",color:n.type==="sent"?"#fff":"inherit",borderRadius:n.type==="sent"?"16px 16px 0 16px":"16px 16px 16px 0",wordBreak:"break-word",boxShadow:"0 1px 2px rgba(0,0,0,0.1)"},children:[n.content||"(\u65E0\u5185\u5BB9)",n.isConcatenated&&(0,c.jsx)(le,{type:"secondary",style:{fontSize:"12px",marginLeft:"8px",color:n.type==="sent"?"#ffffff99":"inherit"},children:n.concatenatedSeq===n.concatenatedTotal?"(\u5B8C\u6574\u5206\u6BB5\u77ED\u4FE1 ".concat(n.concatenatedTotal,"/").concat(n.concatenatedTotal,")"):"(\u4E0D\u5B8C\u6574\u5206\u6BB5\u77ED\u4FE1 ".concat(n.concatenatedSeq,"/").concat(n.concatenatedTotal,")")})]})]})]})})})},qe=(0,k.useRef)(null),Rn=function(){var n;(n=qe.current)===null||n===void 0||n.scrollIntoView({behavior:"smooth"})};(0,k.useEffect)(function(){Rn()},[T]);var qn=function(){var d=O()(F()().mark(function n(){return F()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return he(!0),t.prev=1,t.next=4,Promise.all([se(!0),ge()]);case 4:t.next=10;break;case 6:t.prev=6,t.t0=t.catch(1),console.error("\u624B\u52A8\u5237\u65B0\u77ED\u4FE1\u5931\u8D25:",t.t0),Z.ZP.error("\u5237\u65B0\u77ED\u4FE1\u5217\u8868\u5931\u8D25");case 10:return t.prev=10,he(!1),t.finish(10);case 13:case"end":return t.stop()}},n,null,[[1,6,10,13]])}));return function(){return d.apply(this,arguments)}}(),ur=function(){var d=O()(F()().mark(function n(a){var t,l,r,i,s,e,u,m,f,y,g,p,w,M,v,o,b;return F()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(h.prev=0,console.log("\u6536\u5230\u65B0\u77ED\u4FE1\u901A\u77E5:",a),!(!a.success||!a.data)){h.next=5;break}return console.error("\u65B0\u77ED\u4FE1\u901A\u77E5\u683C\u5F0F\u9519\u8BEF"),h.abrupt("return");case 5:l=typeof a.data=="string"?a.data.split(`
`):[],r="",i="",s="",(t=l[0])!==null&&t!==void 0&&t.startsWith("+CMGR:")&&(e=l[0].split(","),e.length>=4&&(r=e[1].replace(/["+]/g,""),u=e[3].replace(/["]/g,"").trim(),m=u.split(" "),f=x()(m,2),y=f[0],g=f[1],p=y.split("/"),w=x()(p,3),M=w[0],v=w[1],o=w[2],s="20".concat(M,"-").concat(v,"-").concat(o," ").concat(g))),l.length>1&&(i=l[1].trim()),r&&i&&(b={index:-1,content:i,number:E(r),time:s,type:"received"},A(function(j){var ie=E(r),K=j.findIndex(function(nr){return E(nr.number)===ie});if(K>-1){var I=U()(j),Q=Y()({},I[K]);return Q.lastMessage=i,Q.lastTime=s,Q.unreadCount+=1,Q.messages=[].concat(U()(Q.messages),[b]),I[K]=Q,I.splice(K,1),I.unshift(Q),I}else{var er={number:ie,lastMessage:i,lastTime:s,unreadCount:1,messages:[b]};return[er].concat(U()(j))}}),D&&E(D)===E(r)&&C(function(j){return[].concat(U()(j),[b])}),un.ZP.info({message:"\u65B0\u77ED\u4FE1 - \u6765\u81EA: ".concat(r),description:i.length>50?i.substring(0,50)+"...":i,placement:"topRight",duration:10,onClick:function(){R(E(r))}})),setTimeout(function(){se(!0)},1e3),h.next=18;break;case 15:h.prev=15,h.t0=h.catch(0),console.error("\u5904\u7406\u65B0\u77ED\u4FE1\u901A\u77E5\u5931\u8D25:",h.t0);case 18:case"end":return h.stop()}},n,null,[[0,15]])}));return function(a){return d.apply(this,arguments)}}(),or=function(n){if(!(!Array.isArray(n)||n.length===0))try{var a=n.map(function(p){return{index:p.index,content:p.content||"",number:p.number||"",time:p.time||"",type:p.type==="sent"?"sent":"received"}}),t=new Map,l=ue()(a),r;try{for(l.s();!(r=l.n()).done;){var i=r.value;if(i.number||i.number===""){var s=i.number||"\u672A\u77E5\u53F7\u7801",e=E(s),u=t.get(e);u||(u={number:e,lastMessage:i.content,lastTime:i.time||"",unreadCount:0,messages:[]}),u.messages.push(i);var m=i.time?P(i.time):new Date(0),f=u.lastTime?P(u.lastTime):new Date(0);m>f&&(u.lastMessage=i.content,u.lastTime=i.time||""),t.set(e,u)}else console.warn("\u77ED\u4FE1\u6CA1\u6709\u53F7\u7801\u4FE1\u606F:",i)}}catch(p){l.e(p)}finally{l.f()}var y=Array.from(t.values()).sort(function(p,w){var M=P(p.lastTime).getTime(),v=P(w.lastTime).getTime();return v-M});if(console.log("\u4ECE\u672C\u5730\u6570\u636E\u5904\u7406\u540E\u7684\u8054\u7CFB\u4EBA\u5217\u8868:",y),D){var g=y.find(function(p){return E(p.number)===E(D)});C(g?g.messages:[])}else C(a);A(y)}catch(p){console.error("\u5904\u7406\u672C\u5730\u77ED\u4FE1\u6570\u636E\u5931\u8D25:",p)}},lr=function(n,a){if(A(a),D){var t=E(D),l=a.find(function(i){return E(i.number)===t});l?(console.log("\u66F4\u65B0\u9009\u5B9A\u8054\u7CFB\u4EBA\u7684\u6D88\u606F:",l.messages.length),C(l.messages)):C([])}else{var r=U()(n).sort(function(i,s){var e=i.time?P(i.time).getTime():0,u=s.time?P(s.time).getTime():0;return e-u});C(r)}},$n=function(n){try{if(console.log("\u5F00\u59CB\u5904\u7406\u6D88\u606F\u6570\u636E:",n),n.data==="OK"){console.log("\u6536\u5230OK\u54CD\u5E94\uFF0C\u65E0\u9700\u5904\u7406");return}var a=Je(n.data);if(console.log("\u89E3\u6790\u5230\u7684\u77ED\u4FE1:",a),a.length>0){var t=_n(a);console.log("\u5904\u7406\u5206\u6BB5\u77ED\u4FE1\u540E\u7684\u6D88\u606F:",t);var l=new Map;t.forEach(function(s){var e=E(s.number);if(!e){console.warn("\u77ED\u4FE1\u6CA1\u6709\u6709\u6548\u7684\u624B\u673A\u53F7:",s);return}var u=l.get(e);u||(u={number:e,lastMessage:s.content,lastTime:s.time,unreadCount:0,messages:[]},l.set(e,u)),u.messages.push(s);var m=P(s.time),f=u.lastTime?P(u.lastTime):new Date(0);m>f&&(u.lastMessage=s.content,u.lastTime=s.time)});var r=Array.from(l.values());if(A(r),D){var i=r.find(function(s){return E(s.number)===E(D)});i&&(console.log("\u66F4\u65B0\u9009\u4E2D\u8054\u7CFB\u4EBA\u7684\u6D88\u606F:",i.messages),C(i.messages))}else console.log("\u8BBE\u7F6E\u6240\u6709\u6D88\u606F:",t),C(t)}else C([]),A([])}catch(s){console.error("\u5904\u7406\u6D88\u606F\u6570\u636E\u5931\u8D25:",s),C([]),A([])}};(0,k.useEffect)(function(){console.log("\u8054\u7CFB\u4EBA\u5217\u8868\u5DF2\u66F4\u65B0:",N)},[N]),(0,k.useEffect)(function(){console.log("\u6D88\u606F\u5217\u8868\u5DF2\u66F4\u65B0:",T)},[T]);var _n=function(n){console.log("\u5F00\u59CB\u5904\u7406\u5206\u6BB5\u77ED\u4FE1...");var a=new Map,t=[];n.forEach(function(r){var i;if(!r.isConcatenated){t.push(r);return}if(r.concatenatedRef===void 0||r.concatenatedSeq===void 0||r.concatenatedTotal===void 0){console.warn("\u5206\u6BB5\u77ED\u4FE1\u7F3A\u5C11\u5FC5\u8981\u4FE1\u606F:",r),t.push(r);return}var s="".concat(r.number,"-").concat(r.concatenatedRef);console.log("\u5904\u7406\u5206\u6BB5\u77ED\u4FE1:",{key:s,\u53F7\u7801:r.number,\u5F15\u7528\u53F7:r.concatenatedRef,\u5E8F\u53F7:r.concatenatedSeq,\u603B\u6570:r.concatenatedTotal,\u5185\u5BB9:((i=r.content)===null||i===void 0?void 0:i.substring(0,20))+"..."}),a.has(r.number)||a.set(r.number,new Map);var e=a.get(r.number);e.has(r.concatenatedRef)||e.set(r.concatenatedRef,{ref:r.concatenatedRef,total:r.concatenatedTotal,messages:new Array(r.concatenatedTotal),isComplete:!1,number:r.number});var u=e.get(r.concatenatedRef),m=r.concatenatedSeq-1;m>=0&&m<u.total?(u.messages[m]=r,u.isComplete=u.messages.filter(function(f){return f!==void 0}).length===u.total):(console.warn("\u5206\u6BB5\u77ED\u4FE1\u5E8F\u53F7\u8D85\u51FA\u8303\u56F4:",{\u5E8F\u53F7:r.concatenatedSeq,\u603B\u6BB5\u6570:u.total,\u6D88\u606F:r}),t.push(r))});var l=[].concat(t);return a.forEach(function(r,i){r.forEach(function(s){if(console.log("\u68C0\u67E5\u5206\u6BB5\u77ED\u4FE1\u7EC4: \u53F7\u7801=".concat(i,", \u5F15\u7528\u53F7=").concat(s.ref,", \u603B\u6BB5\u6570=").concat(s.total,", \u5B8C\u6574\u6027=").concat(s.isComplete)),console.log("\u5F53\u524D\u7EC4\u7684\u6D88\u606F:",s.messages.map(function(g,p){var w;return g?"\u6BB5".concat(p+1,": ").concat((w=g.content)===null||w===void 0?void 0:w.substring(0,20),"..."):"\u6BB5".concat(p+1,": \u7F3A\u5931")})),s.isComplete){var e=s.messages.filter(function(g){return g!==void 0}).sort(function(g,p){return(g.concatenatedSeq||0)-(p.concatenatedSeq||0)}),u=e.every(function(g,p){return g.concatenatedSeq===p+1});if(!u){console.warn("\u5206\u6BB5\u77ED\u4FE1\u987A\u5E8F\u4E0D\u8FDE\u7EED:",{\u53F7\u7801:i,\u5F15\u7528\u53F7:s.ref,\u6D88\u606F:e.map(function(g){var p;return{\u5E8F\u53F7:g.concatenatedSeq,\u5185\u5BB9:((p=g.content)===null||p===void 0?void 0:p.substring(0,20))+"..."}})}),s.messages.forEach(function(g){g&&l.push(g)});return}var m=e.map(function(g){return g.content||""}).join(""),f=e[0],y=Y()(Y()({},f),{},{content:m,isConcatenated:!0,concatenatedRef:s.ref,concatenatedSeq:s.total,concatenatedTotal:s.total,index:f.index});console.log("\u5408\u5E76\u540E\u7684\u6D88\u606F:",{\u53F7\u7801:y.number,\u5185\u5BB9\u957F\u5EA6:y.content.length,\u5185\u5BB9\u9884\u89C8:y.content.substring(0,50)+"...",\u5206\u6BB5\u6570:s.total,\u5F15\u7528\u53F7:s.ref}),l.push(y)}else console.log("\u4E0D\u5B8C\u6574\u7684\u5206\u6BB5\u77ED\u4FE1\u7EC4: \u53F7\u7801=".concat(i,", \u5F15\u7528\u53F7=").concat(s.ref)),s.messages.forEach(function(g){g&&l.push(g)})})}),l.sort(function(r,i){var s=P(r.time).getTime(),e=P(i.time).getTime();return s===e?r.index-i.index:s-e})};return(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)(on.Z,{title:(0,c.jsxs)(ye.Z,{children:[(0,c.jsx)("span",{children:"\u77ED\u4FE1\u4E2D\u5FC3"}),(0,c.jsxs)("span",{style:{fontSize:"14px",fontWeight:"normal",color:"#999"},children:["\u5B58\u50A8\u7A7A\u95F4: ",te.used,"/",te.total,(0,c.jsx)(ln.Z,{percent:Math.round(te.used/te.total*100),status:te.used>=te.total?"exception":"normal",showInfo:!1,style:{width:"80px",marginLeft:"8px",display:"inline-block"},size:"small"})]})]}),extra:(0,c.jsxs)(ye.Z,{children:[(0,c.jsx)(J.ZP,{type:"primary",icon:(0,c.jsx)(be.Z,{}),onClick:function(){return me(!0)},disabled:!Ge||!ce,title:Ge?ce?"":"IMS\u529F\u80FD\u672A\u5F00\u542F":"\u77ED\u4FE1\u529F\u80FD\u672A\u5F00\u542F",children:"\u53D1\u9001\u65B0\u77ED\u4FE1"}),D&&(0,c.jsxs)(ye.Z,{children:[(0,c.jsx)(J.ZP,{danger:q,onClick:function(){return Pe(!q)},children:q?"\u53D6\u6D88\u6279\u91CF\u5220\u9664":"\u6279\u91CF\u5220\u9664"}),q&&(0,c.jsx)(J.ZP,{onClick:function(){G.length===T.length?$([]):$(T.map(function(n){return n.index}))},children:G.length===T.length?"\u53D6\u6D88\u5168\u9009":"\u5168\u9009"})]}),(0,c.jsx)(J.ZP,{onClick:qn,icon:(0,c.jsx)(dn.Z,{spin:xn}),loading:ae,children:"\u5237\u65B0"})]}),children:[(0,c.jsxs)(Se.Z,{style:{background:"#fff",minHeight:"70vh",height:"100%"},children:[(0,c.jsx)(Tn,{width:300,style:{background:"#fff",borderRight:"1px solid #f0f0f0"},breakpoint:"lg",collapsedWidth:0,children:(0,c.jsx)(oe.Z,{loading:ae,dataSource:N,style:{overflowY:"auto",height:"calc(100vh - 200px)"},renderItem:function(n){var a;return(0,c.jsxs)(oe.Z.Item,{style:{cursor:"pointer",background:D===n.number?"#f0f0f0":"transparent",padding:"12px"},onClick:function(){return R(n.number)},children:[(0,c.jsx)(oe.Z.Item.Meta,{avatar:(0,c.jsx)(cn.Z,{icon:(0,c.jsx)(vn.Z,{})}),title:(0,c.jsx)("div",{style:{display:"flex",justifyContent:"space-between"},children:(0,c.jsx)(le,{strong:!0,children:n.number})}),description:((a=n.messages)===null||a===void 0||(a=a[n.messages.length-1])===null||a===void 0?void 0:a.content)||n.lastMessage}),n.unreadCount>0&&(0,c.jsx)(fn.Z,{count:n.unreadCount,style:{marginLeft:8}})]})}})}),(0,c.jsx)(En,{style:{padding:"0 24px"},children:D?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{style:{height:"calc(70vh - 150px)",overflowY:"auto",padding:"24px 0",display:"flex",flexDirection:"column"},children:T.length>0?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(oe.Z,{dataSource:T.sort(function(d,n){var a=P(d.time),t=P(n.time);return a.getTime()-t.getTime()}),renderItem:Xn,style:{display:"flex",flexDirection:"column"}}),(0,c.jsx)("div",{ref:qe})]}):(0,c.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",flexDirection:"column",gap:"16px"},children:ae?(0,c.jsx)("div",{children:"\u52A0\u8F7D\u4E2D..."}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(hn.Z,{style:{fontSize:"32px",color:"#d9d9d9"}}),(0,c.jsx)(le,{type:"secondary",children:"\u6CA1\u6709\u6D88\u606F\u8BB0\u5F55"})]})})}),q&&G.length>0&&(0,c.jsx)("div",{style:{textAlign:"center",padding:"16px 0"},children:(0,c.jsxs)(J.ZP,{type:"primary",danger:!0,onClick:function(){return Yn()},loading:ae,children:["\u5220\u9664\u9009\u4E2D\u7684 ",G.length," \u6761\u77ED\u4FE1"]})}),!q&&(0,c.jsxs)("div",{style:{borderTop:"1px solid #f0f0f0",padding:"12px 8px",display:"flex",gap:"8px",background:"#fff"},children:[(0,c.jsx)(ke,{value:ne,onChange:function(n){return re(n.target.value)},placeholder:ce?"\u8BF7\u8F93\u5165\u77ED\u4FE1\u5185\u5BB9":"IMS\u529F\u80FD\u672A\u5F00\u542F\uFF0C\u65E0\u6CD5\u53D1\u9001\u77ED\u4FE1",autoSize:{minRows:2,maxRows:4},style:{flex:1},disabled:!ce}),(0,c.jsx)(J.ZP,{type:"primary",icon:(0,c.jsx)(be.Z,{}),onClick:Re,loading:ae,style:{height:"auto"},disabled:!ce,children:"\u53D1\u9001"})]})]}):(0,c.jsx)("div",{style:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,c.jsx)(le,{type:"secondary",children:'\u9009\u62E9\u8054\u7CFB\u4EBA\u6216\u70B9\u51FB"\u53D1\u9001\u65B0\u77ED\u4FE1"\u6309\u94AE\u5F00\u59CB\u65B0\u5BF9\u8BDD'})})})]}),(0,c.jsx)(Ce.Z,{title:"\u53D1\u9001\u65B0\u77ED\u4FE1",open:Mn,onCancel:function(){me(!1),we(""),re("")},footer:null,children:(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[(0,c.jsx)(Fe.Z,{placeholder:"\u8BF7\u8F93\u5165\u65B0\u8054\u7CFB\u4EBA\u53F7\u7801",value:Ee,onChange:function(n){return we(n.target.value)}}),(0,c.jsx)(ke,{value:ne,onChange:function(n){return re(n.target.value)},placeholder:"\u8BF7\u8F93\u5165\u77ED\u4FE1\u5185\u5BB9",autoSize:{minRows:4,maxRows:6}}),(0,c.jsx)(J.ZP,{type:"primary",icon:(0,c.jsx)(be.Z,{}),onClick:function(){Re(),Ee&&ne&&me(!1)},loading:ae,block:!0,children:"\u53D1\u9001"})]})})]})})},Bn=wn}}]);
